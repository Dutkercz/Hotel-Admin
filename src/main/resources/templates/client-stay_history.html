<!doctype html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Histórico de Diárias</title>
</head>
<body class="bg-slate-50 min-h-screen flex items-center flex-col p-8">

<div class="bg-white rounded-3xl shadow-2xl p-12 w-full max-w-7xl mx-auto my-12">

    <h1 class="text-slate-800 font-bold text-5xl text-center mb-10 drop-shadow-sm">
        Histórico de Diárias
    </h1>

    <div class="bg-slate-100 rounded-2xl shadow-inner p-8 w-full max-w-lg mx-auto mb-8">
        <h2 class="text-slate-700 font-semibold text-xl mb-3">Busca por CPF</h2>
        <div class="flex flex-col sm:flex-row gap-4">
            <input type="text" id="cpf" name="cpf" placeholder="Apenas números do CPF"
                   class="flex-1 border border-slate-300 rounded-xl px-4 py-3 focus:outline-none
                          focus:ring-2 focus:ring-sky-500 shadow-sm text-slate-800 transition-colors">
            <button type="button"
                    onclick="window.location.href='/clients/client-history/' + document.getElementById('cpf').value"
                    class="bg-sky-600 text-white px-8 py-3 rounded-xl shadow-md hover:bg-sky-700
                           transition-all font-semibold transform hover:scale-105">
                Buscar
            </button>
        </div>
    </div>

    <div th:if="${error != null}"
         class="mb-6 p-4 rounded-xl bg-red-50 border border-red-300 text-red-600 text-center font-semibold shadow-sm">
        <span th:text="${error}"></span>
    </div>

    <div th:if="${client != null}"
         class="bg-slate-100 rounded-2xl shadow-inner p-8 w-full max-w-lg mx-auto mb-8">
        <h3 class="text-slate-700 font-semibold text-xl mb-3">Cliente</h3>
        <p class="text-2xl font-bold text-slate-800">
            <span th:text="${client.firstName + ' ' + client.lastName}"></span>
        </p>
        <p class="mt-2">
            <span th:text="${client.status}"
                  th:classappend="${client.status == client.status.ACTIVE ? 'text-emerald-500' :
                   client.status == client.status.INACTIVE ? 'text-red-500' : 'text-slate-500'}"
                  class="font-semibold text-lg" >
            </span>
        </p>
    </div>

    <div class="bg-white rounded-3xl shadow-xl p-8 overflow-x-auto border border-slate-200">
        <h4 class="text-3xl font-bold text-slate-800 text-center mb-8">Tabela de Histórico</h4>
        <table class="w-full text-left rounded-2xl overflow-hidden border-collapse">
            <thead class="bg-sky-600 text-white shadow-md rounded-t-2xl">
            <tr>
                <th class="py-4 px-6">Data check-in</th>
                <th class="py-4 px-6">Data check-out</th>
                <th class="py-4 px-6">Total de Diárias</th>
                <th class="py-4 px-6">Pessoas no Apto.</th>
                <th class="py-4 px-6">Status da Diária</th>
            </tr>
            </thead>
            <tbody th:if="${!clientStays.isEmpty()}" class="divide-y divide-slate-200">
            <tr th:each="cs : ${clientStays}" class="hover:bg-sky-50 transition-colors">
                <td class="py-4 px-6" th:text="${#temporals.format(cs.checkIn, 'dd/MM/yyyy')}"></td>
                <td class="py-4 px-6" th:text="${#temporals.format(cs.checkOut, 'dd/MM/yyyy')}"></td>
                <td class="py-4 px-6" th:text="${cs.stayAmount}"></td>
                <td class="py-4 px-6" th:text="${cs.guests.size() + 1}"></td>
                <td class="py-4 px-6 font-semibold"
                    th:text="${cs.status == cs.status.ACTIVE ? 'ATIVA' : cs.status == cs.status.FINISHED ? 'FINALIZADA' : 'CANCELADA'}"
                    th:classappend="${cs.status == cs.status.ACTIVE ? 'text-emerald-600' : cs.status == cs.status.FINISHED ? 'text-sky-600' : 'text-red-600'}">
                </td>
            </tr>
            </tbody>
            <tbody th:if="${clientStays.isEmpty()}">
            <tr>
                <td colspan="5" class="text-center py-8 text-slate-400 italic font-light">
                    Nenhum histórico encontrado para este cliente.
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<footer class="w-full text-center p-6 bg-slate-800 flex flex-col items-center justify-center mt-12">
    <div class="flex items-center space-x-4 mb-2">
        <h4 class="text-white font-semibold text-lg">Nos siga nas redes sociais</h4>
        <a href="https://www.google.com" target="_blank" rel="noopener noreferrer"
           class="text-white font-semibold px-6 py-2 bg-sky-600 rounded-full hover:shadow-lg transition-transform transform hover:scale-105">
            Instagram
        </a>
    </div>
    <h5 class="p-2 text-slate-400 font-normal text-sm">CNPJ: 88.727.599/0001-00</h5>
</footer>
</body>
</html>
